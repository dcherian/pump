
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Examine EQUIX Chameleon data &#8212; PUMP</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Long-term tubulence in 20-year simulation" href="long-term-turbulence.html" />
    <link rel="prev" title="EQUIX: Jq divergence" href="equix-divergence.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">PUMP</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  TIW Turbulence
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="TIW-DCL.html">
   TIW DCL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dcl-paper.html">
   TIW DCL Paper Figures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ctd-adcp.html">
   TIW Cruise Sections
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="TIW-compositing.html">
   TIW Compositing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="vertical-velocity.html">
   TIW vertical velocity in MITgcm simulations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tiw-floats.html">
   EM-APEX floats in TIWs
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Marginal Stability
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="bulk-Ri.html">
   Bulk Ri analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="MI-extent.html">
   Extent of marginal stability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tao-ri-analysis.html">
   TAO Ri analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mi-simple-model.html">
   Simple model analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="shred2-evol.html">
   Reduced Shear Evolution equation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  χpod/Chameleon
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="equix-divergence.html">
   EQUIX: Jq divergence
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Examine EQUIX Chameleon data
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Other
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="long-term-turbulence.html">
   Long-term tubulence in 20-year simulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="les-tendencies.html">
   LES tendencies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="heat-momentum-budget-checks.html">
   Heat and momentum budgets with MITgcm output
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="submeso-deep-100.html">
   Deep submesoscales in 1/100°?
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/equix-examine.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/dcherian/pump"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/dcherian/pump/master?urlpath=tree/notebooks/equix-examine.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#test-thorpe-sorting">
   Test thorpe sorting
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sorting-and-calculating-gradients">
   Sorting and calculating gradients
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#different-jq-calculations">
   Different Jq calculations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#j-q-vs-j-q">
   <span class="math notranslate nohighlight">
    \(J_q^ε\)
   </span>
   vs
   <span class="math notranslate nohighlight">
    \(J_q^χ\)
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#perlin-moum">
   Perlin &amp; Moum:
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     χ, ε
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tz-n2">
     Tz, N2
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tiwe">
   TIWE
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reproducing-perlin-moum-2012">
   Reproducing Perlin &amp; Moum (2012)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#explorations">
   Explorations
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Examine EQUIX Chameleon data</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#test-thorpe-sorting">
   Test thorpe sorting
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sorting-and-calculating-gradients">
   Sorting and calculating gradients
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#different-jq-calculations">
   Different Jq calculations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#j-q-vs-j-q">
   <span class="math notranslate nohighlight">
    \(J_q^ε\)
   </span>
   vs
   <span class="math notranslate nohighlight">
    \(J_q^χ\)
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#perlin-moum">
   Perlin &amp; Moum:
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     χ, ε
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tz-n2">
     Tz, N2
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tiwe">
   TIWE
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reproducing-perlin-moum-2012">
   Reproducing Perlin &amp; Moum (2012)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#explorations">
   Explorations
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="examine-equix-chameleon-data">
<h1>Examine EQUIX Chameleon data<a class="headerlink" href="#examine-equix-chameleon-data" title="Permalink to this headline">¶</a></h1>
<p>I’m confused by disagreements between heat flux calculated from χ or ε.</p>
<p>TODO:</p>
<ol class="simple">
<li class="task-list-item"><p><input class="task-list-item-checkbox" checked="checked" disabled="disabled" type="checkbox"> calculate gradients using sorted profiles; this bumps up Jq by a factor of 2!</p>
<ul class="simple">
<li><p>Sasha’s dTdz is calculated using θ sorted by θ, and N2 is calculated using σ sorted by σ</p></li>
<li><p>Sasha’s χpod N2 = gα dTdz with α calculated using S=34</p></li>
</ul>
</li>
<li><p>Seems very sensitive to low gradient locations</p></li>
<li><p>Figure out what level to filter χ, ε at: 1e-2? 1e-5 in jims multiprofv2.m</p></li>
<li><p>Add values for sensor 1, sensor2 to χpod datasets</p></li>
<li><p>Add Jq_ε for χpods</p></li>
<li><p>Try with TH or TIWE</p></li>
</ol>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> watermark
<span class="o">%</span><span class="k">matplotlib</span> inline


<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">cf_xarray</span> <span class="k">as</span> <span class="nn">cfxr</span>
<span class="kn">import</span> <span class="nn">dcpy</span>
<span class="kn">import</span> <span class="nn">distributed</span>
<span class="kn">import</span> <span class="nn">hvplot.xarray</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">dcpy.oceans</span> <span class="kn">import</span> <span class="n">read_osu_microstructure_mat</span><span class="p">,</span> <span class="n">thorpesort</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="c1"># import eddydiff as ed</span>
<span class="kn">import</span> <span class="nn">pump</span>

<span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.dpi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">140</span>

<span class="o">%</span><span class="k">watermark</span> -iv
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Jq</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">min_dTdz</span><span class="p">):</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="p">(</span>
            <span class="mi">1025</span>
            <span class="o">*</span> <span class="mi">4000</span>
            <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">chi</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">chi</span> <span class="o">&lt;</span> <span class="mf">2e-2</span><span class="p">)</span>
            <span class="o">/</span> <span class="mi">2</span>
            <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">dTdz</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dTdz</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">min_dTdz</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">read_osu_microstructure_mat</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;/Users/dcherian/datasets/microstructure/osu/eq08_sum_deglitched.mat&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cham</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/datasets/microstructure/osu/equix.nc&quot;</span><span class="p">))</span>

<span class="n">theta_old</span> <span class="o">=</span> <span class="n">cham</span><span class="o">.</span><span class="n">theta</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cham</span><span class="p">[</span><span class="s2">&quot;depth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cham</span><span class="o">.</span><span class="n">depth</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">cham</span><span class="p">[</span><span class="s2">&quot;sortTbyT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thorpesort</span><span class="p">(</span><span class="n">cham</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span> <span class="n">cham</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">cham</span><span class="p">[</span><span class="s2">&quot;sortT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thorpesort</span><span class="p">(</span><span class="n">cham</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span> <span class="n">cham</span><span class="o">.</span><span class="n">pden</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cham</span><span class="p">[</span><span class="s2">&quot;NT2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="o">-</span><span class="mf">9.81</span>
    <span class="o">*</span> <span class="n">dcpy</span><span class="o">.</span><span class="n">eos</span><span class="o">.</span><span class="n">alpha</span><span class="p">(</span>
        <span class="mi">34</span> <span class="o">*</span> <span class="n">xr</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">cham</span><span class="o">.</span><span class="n">theta</span><span class="p">),</span> <span class="n">cham</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span> <span class="n">cham</span><span class="o">.</span><span class="n">pres</span><span class="o">.</span><span class="n">broadcast_like</span><span class="p">(</span><span class="n">cham</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">*</span> <span class="n">cham</span><span class="o">.</span><span class="n">dTdz</span>
<span class="p">)</span>

<span class="n">chamρ</span> <span class="o">=</span> <span class="n">cham</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">chamρ</span><span class="p">[</span><span class="s2">&quot;dTdz&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">chamρ</span><span class="o">.</span><span class="n">sortT</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">)</span>

<span class="n">chamT</span> <span class="o">=</span> <span class="n">cham</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">chamT</span><span class="p">[</span><span class="s2">&quot;dTdz&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">chamT</span><span class="o">.</span><span class="n">sortTbyT</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">)</span>

<span class="n">cham</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:          (depth: 200, time: 2624, zeuc: 80)
Coordinates:
  * depth            (depth) float64 1.0 2.0 3.0 4.0 ... 197.0 198.0 199.0 200.0
    lon              (time) float64 -139.9 -139.9 -139.9 ... -139.9 -139.9
    lat              (time) float64 0.06246 0.0622 0.06263 ... 0.06317 0.06341
  * time             (time) datetime64[ns] 2008-10-24T20:36:23 ... 2008-11-08...
  * zeuc             (zeuc) float64 -200.0 -195.0 -190.0 ... 185.0 190.0 195.0
Data variables: (12/48)
    pmax             (time) float64 205.9 199.0 202.0 ... 202.0 221.1 203.9
    castnumber       (time) uint16 16 17 18 19 20 ... 2664 2665 2666 2667 2668
    AX_TILT          (depth, time) float64 9.642 -48.16 nan ... 4.232 1.28
    AY_TILT          (depth, time) float64 14.52 11.51 nan ... -2.121 0.05032
    AZ2              (depth, time) float64 0.04277 1.537e-05 ... 3.208e-06
    C                (depth, time) float64 5.244 5.291 nan ... 4.135 4.137 4.164
    ...               ...
    count_Jq_euc     (time, zeuc) int64 0 0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0 0
    count_dJdz_euc   (time, zeuc) int64 0 0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0 0
    count_dTdt_euc   (time, zeuc) int64 0 0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0 0
    count_u_euc      (time, zeuc) int64 0 0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0 0
    count_depth_euc  (time, zeuc) int64 0 0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0 0
    NT2              (depth, time) float64 nan nan nan ... 0.0001089 0.000102
Attributes:
    starttime:  [&#x27;Time:20:34:29 298   &#x27; &#x27;Time:20:42:18 298   &#x27; &#x27;Time:20:52:14...
    endtime:    [&#x27;Time:20:38:29 298   &#x27; &#x27;Time:20:46:29 298   &#x27; &#x27;Time:20:56:29...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-f210ddc5-4e9b-432f-a2a2-60e783bf1278' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-f210ddc5-4e9b-432f-a2a2-60e783bf1278' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>depth</span>: 200</li><li><span class='xr-has-index'>time</span>: 2624</li><li><span class='xr-has-index'>zeuc</span>: 80</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-97acfcd8-b563-4d28-8955-774d36b2bc0d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-97acfcd8-b563-4d28-8955-774d36b2bc0d' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>depth</span></div><div class='xr-var-dims'>(depth)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0 2.0 3.0 ... 198.0 199.0 200.0</div><input id='attrs-8811b403-7a60-40d6-beb8-76114f60c6ec' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8811b403-7a60-40d6-beb8-76114f60c6ec' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7e53e4ad-41c1-45ab-8e1a-9a612250e694' class='xr-var-data-in' type='checkbox'><label for='data-7e53e4ad-41c1-45ab-8e1a-9a612250e694' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd></dl></div><div class='xr-var-data'><pre>array([  1.,   2.,   3.,   4.,   5.,   6.,   7.,   8.,   9.,  10.,  11.,  12.,
        13.,  14.,  15.,  16.,  17.,  18.,  19.,  20.,  21.,  22.,  23.,  24.,
        25.,  26.,  27.,  28.,  29.,  30.,  31.,  32.,  33.,  34.,  35.,  36.,
        37.,  38.,  39.,  40.,  41.,  42.,  43.,  44.,  45.,  46.,  47.,  48.,
        49.,  50.,  51.,  52.,  53.,  54.,  55.,  56.,  57.,  58.,  59.,  60.,
        61.,  62.,  63.,  64.,  65.,  66.,  67.,  68.,  69.,  70.,  71.,  72.,
        73.,  74.,  75.,  76.,  77.,  78.,  79.,  80.,  81.,  82.,  83.,  84.,
        85.,  86.,  87.,  88.,  89.,  90.,  91.,  92.,  93.,  94.,  95.,  96.,
        97.,  98.,  99., 100., 101., 102., 103., 104., 105., 106., 107., 108.,
       109., 110., 111., 112., 113., 114., 115., 116., 117., 118., 119., 120.,
       121., 122., 123., 124., 125., 126., 127., 128., 129., 130., 131., 132.,
       133., 134., 135., 136., 137., 138., 139., 140., 141., 142., 143., 144.,
       145., 146., 147., 148., 149., 150., 151., 152., 153., 154., 155., 156.,
       157., 158., 159., 160., 161., 162., 163., 164., 165., 166., 167., 168.,
       169., 170., 171., 172., 173., 174., 175., 176., 177., 178., 179., 180.,
       181., 182., 183., 184., 185., 186., 187., 188., 189., 190., 191., 192.,
       193., 194., 195., 196., 197., 198., 199., 200.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-139.9 -139.9 ... -139.9 -139.9</div><input id='attrs-e8b0618c-cdec-4a0b-9397-18269767b0e1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e8b0618c-cdec-4a0b-9397-18269767b0e1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e25900ad-7228-4963-8dc9-55280ead29f9' class='xr-var-data-in' type='checkbox'><label for='data-e25900ad-7228-4963-8dc9-55280ead29f9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([-139.868406  , -139.86840867, -139.86840817, ..., -139.87721183,
       -139.87707   , -139.877121  ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.06246 0.0622 ... 0.06317 0.06341</div><input id='attrs-45b421ed-a251-4d10-9c5e-690ecdcea507' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-45b421ed-a251-4d10-9c5e-690ecdcea507' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7559bf93-1d83-436f-98bb-fe66cdf5b02a' class='xr-var-data-in' type='checkbox'><label for='data-7559bf93-1d83-436f-98bb-fe66cdf5b02a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([0.06245817, 0.06219917, 0.06263083, ..., 0.06311433, 0.063169  ,
       0.0634125 ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2008-10-24T20:36:23 ... 2008-11-...</div><input id='attrs-c49840bd-2da6-431c-ae27-a3acc97fffc4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c49840bd-2da6-431c-ae27-a3acc97fffc4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-95a30948-346c-4a0e-9b98-8b5dee1796ab' class='xr-var-data-in' type='checkbox'><label for='data-95a30948-346c-4a0e-9b98-8b5dee1796ab' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2008-10-24T20:36:23.000000000&#x27;, &#x27;2008-10-24T20:44:18.000000000&#x27;,
       &#x27;2008-10-24T20:54:17.000000000&#x27;, ..., &#x27;2008-11-08T18:58:49.000000000&#x27;,
       &#x27;2008-11-08T19:06:14.000000000&#x27;, &#x27;2008-11-08T19:13:47.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>zeuc</span></div><div class='xr-var-dims'>(zeuc)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-200.0 -195.0 ... 190.0 195.0</div><input id='attrs-95d99820-84e3-4209-bfc1-057b7a51bbfd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-95d99820-84e3-4209-bfc1-057b7a51bbfd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e9b02f76-062b-4084-ba24-b767c59cb2ec' class='xr-var-data-in' type='checkbox'><label for='data-e9b02f76-062b-4084-ba24-b767c59cb2ec' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>positive :</span></dt><dd>up</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>long_name :</span></dt><dd>$z - z_{EUC}$</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([-200., -195., -190., -185., -180., -175., -170., -165., -160., -155.,
       -150., -145., -140., -135., -130., -125., -120., -115., -110., -105.,
       -100.,  -95.,  -90.,  -85.,  -80.,  -75.,  -70.,  -65.,  -60.,  -55.,
        -50.,  -45.,  -40.,  -35.,  -30.,  -25.,  -20.,  -15.,  -10.,   -5.,
          0.,    5.,   10.,   15.,   20.,   25.,   30.,   35.,   40.,   45.,
         50.,   55.,   60.,   65.,   70.,   75.,   80.,   85.,   90.,   95.,
        100.,  105.,  110.,  115.,  120.,  125.,  130.,  135.,  140.,  145.,
        150.,  155.,  160.,  165.,  170.,  175.,  180.,  185.,  190.,  195.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-cad936b1-38ae-4390-8979-0a4b9df366ed' class='xr-section-summary-in' type='checkbox'  ><label for='section-cad936b1-38ae-4390-8979-0a4b9df366ed' class='xr-section-summary' >Data variables: <span>(48)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>pmax</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>205.9 199.0 202.0 ... 221.1 203.9</div><input id='attrs-dfa1f9a5-72d3-4d5e-b77b-cccd224f3fff' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-dfa1f9a5-72d3-4d5e-b77b-cccd224f3fff' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-681aefe0-70af-4256-84f5-e9cf1551b3de' class='xr-var-data-in' type='checkbox'><label for='data-681aefe0-70af-4256-84f5-e9cf1551b3de' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([205.93651536, 199.00510569, 202.00242137, ..., 202.01574447,
       221.05402492, 203.86125274])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>castnumber</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>uint16</div><div class='xr-var-preview xr-preview'>16 17 18 19 ... 2665 2666 2667 2668</div><input id='attrs-2433b6c7-d89e-4739-83d4-762af90815d1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2433b6c7-d89e-4739-83d4-762af90815d1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eca0f86a-e4d5-4b99-aedf-e99af5b19724' class='xr-var-data-in' type='checkbox'><label for='data-eca0f86a-e4d5-4b99-aedf-e99af5b19724' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  16,   17,   18, ..., 2666, 2667, 2668], dtype=uint16)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>AX_TILT</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>9.642 -48.16 nan ... 4.232 1.28</div><input id='attrs-c6227864-696b-4b5a-b33e-c074ae05be56' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c6227864-696b-4b5a-b33e-c074ae05be56' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ec3f12bf-7b58-40ab-aee9-b2232e6ca470' class='xr-var-data-in' type='checkbox'><label for='data-ec3f12bf-7b58-40ab-aee9-b2232e6ca470' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[  9.6415086 , -48.1621952 ,          nan, ...,  18.72828545,
         -3.13667593,  -8.95575698],
       [  4.48395055, -29.14773185, -20.50153375, ...,  12.16208812,
          3.27053706,   1.25283798],
       [ -0.13846664,  -7.77567798, -14.26841612, ...,   9.26100792,
         -2.38159718,   2.74543967],
       ...,
       [ -0.3999788 ,   0.07714795,   0.58404001, ...,   0.49822554,
          3.94440538,   0.89481111],
       [ -0.46398325,   0.14535449,   0.63026535, ...,   0.77353237,
          3.86853844,   1.1196056 ],
       [ -0.37911422,          nan,   0.66167671, ...,   0.70312844,
          4.23175887,   1.27969235]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>AY_TILT</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>14.52 11.51 nan ... -2.121 0.05032</div><input id='attrs-9b24dfb6-6fbc-479b-8abd-4f0be313225b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9b24dfb6-6fbc-479b-8abd-4f0be313225b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e1bff1cf-bc69-46c7-82e3-0afe2a064c47' class='xr-var-data-in' type='checkbox'><label for='data-e1bff1cf-bc69-46c7-82e3-0afe2a064c47' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 14.51707181,  11.51004005,          nan, ...,  12.94259749,
        -11.99588899,  10.36633469],
       [  8.29206899,   0.27859885,  25.40831564, ...,   4.54467415,
        -11.67177988,  -2.32980951],
       [  4.21619137,  -4.57057204,   9.25361889, ...,  -1.71790709,
        -11.36777373,  -2.70731467],
       ...,
       [ -1.98386615,  -1.61662696,  -1.81510711, ...,  -3.30561771,
         -1.87552638,  -0.13780247],
       [ -1.63654255,  -1.54284209,  -0.53946635, ...,  -2.81611526,
         -1.96872885,   0.09218141],
       [ -1.76751644,          nan,  -1.11048116, ...,  -2.62284326,
         -2.12143302,   0.05032124]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>AZ2</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.04277 1.537e-05 ... 3.208e-06</div><input id='attrs-8fcd331e-7cd5-496a-82a6-1eb0fc6bb905' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8fcd331e-7cd5-496a-82a6-1eb0fc6bb905' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dd7a5082-9b7b-4ef4-9992-f0ad9be9d381' class='xr-var-data-in' type='checkbox'><label for='data-dd7a5082-9b7b-4ef4-9992-f0ad9be9d381' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[4.27664058e-02, 1.53715094e-05,            nan, ...,
        7.59505551e-05, 8.39366578e-05, 1.09701154e-05],
       [1.03387939e-03, 1.54596556e-05, 1.40649348e-04, ...,
        8.28469167e-06, 1.77544082e-05, 1.79382639e-06],
       [1.87232177e-04, 4.54068550e-06, 3.12812997e-05, ...,
        1.45697632e-05, 1.70089546e-05, 3.11248317e-06],
       ...,
       [6.75551720e-06, 4.57687418e-06, 5.43906674e-06, ...,
        1.50305291e-05, 2.90585558e-06, 4.50582475e-06],
       [1.17132603e-05, 5.66169186e-06, 1.36095944e-05, ...,
        2.24203923e-06, 2.69464518e-06, 5.84454101e-06],
       [8.83178862e-06,            nan, 6.95564234e-06, ...,
        2.91223680e-06, 2.61247030e-06, 3.20761422e-06]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>C</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.244 5.291 nan ... 4.137 4.164</div><input id='attrs-374131ea-9f86-423f-8ff4-07f7fa17dead' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-374131ea-9f86-423f-8ff4-07f7fa17dead' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cb48806a-016f-42fe-a4dd-90f1315f8abb' class='xr-var-data-in' type='checkbox'><label for='data-cb48806a-016f-42fe-a4dd-90f1315f8abb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[5.24361252, 5.29091272,        nan, ..., 5.3270191 , 5.32578171,
        5.32420136],
       [5.25265171, 5.29101586, 5.29345613, ..., 5.32714884, 5.32556902,
        5.32445287],
       [5.25770276, 5.29102466, 5.29076007, ..., 5.32708654, 5.32548386,
        5.32448295],
       ...,
       [4.15348212, 4.1562709 , 4.15720205, ..., 4.14974132, 4.14999048,
        4.17485331],
       [4.15389983, 4.15688293, 4.15742006, ..., 4.14276969, 4.14630483,
        4.16952148],
       [4.15413389,        nan, 4.15719298, ..., 4.13482505, 4.13726266,
        4.16428369]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>chi</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.127e-06 5.712e-06 ... 9.245e-09</div><input id='attrs-b319c05e-5c01-43ee-954e-dc0ca8c55a62' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b319c05e-5c01-43ee-954e-dc0ca8c55a62' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-291412ac-8330-4385-a6e6-7221b5373056' class='xr-var-data-in' type='checkbox'><label for='data-291412ac-8330-4385-a6e6-7221b5373056' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$χ$</dd><dt><span>units :</span></dt><dd>°C²/s</dd></dl></div><div class='xr-var-data'><pre>array([[2.12688399e-06, 5.71155698e-06,            nan, ...,
        8.82606312e-08, 2.63317798e-07, 1.68773527e-07],
       [5.70552553e-06, 2.91639050e-07, 5.98322336e-07, ...,
        2.92447426e-07, 5.29761470e-08, 1.09335352e-07],
       [5.42809819e-07, 2.24326272e-07, 9.18169419e-07, ...,
        5.27180297e-07, 2.36618875e-07, 4.85419585e-08],
       ...,
       [1.17618518e-11, 1.51284284e-11, 1.55842645e-10, ...,
        1.00900275e-07, 6.94714665e-07, 7.72806894e-09],
       [1.32466080e-11, 4.03601274e-11, 1.91113796e-11, ...,
        2.34244678e-07, 2.62691364e-06, 7.94421817e-09],
       [2.13465286e-11,            nan, 1.42169165e-11, ...,
        4.00016873e-09, 2.59171599e-09, 9.24455507e-09]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>DRHODZ</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.06179 0.02443 ... 0.00606</div><input id='attrs-0e7132c4-f04a-4c53-9f05-5e173c9a3ec5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0e7132c4-f04a-4c53-9f05-5e173c9a3ec5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f9a81af7-3908-4db4-a5c3-83e337965f24' class='xr-var-data-in' type='checkbox'><label for='data-f9a81af7-3908-4db4-a5c3-83e337965f24' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[0.06178772, 0.02442927,        nan, ..., 0.00440173, 0.04270047,
        0.01252588],
       [0.04204941, 0.00085125, 0.00576653, ..., 0.00142232, 0.00108993,
        0.00133526],
       [0.01732687, 0.00076531, 0.00467756, ..., 0.00089522, 0.0008274 ,
        0.0005783 ],
       ...,
       [0.00159717, 0.00099967, 0.00072395, ..., 0.00777257, 0.00572349,
        0.00708041],
       [0.00145471, 0.0007196 , 0.00086594, ..., 0.00934785, 0.0087413 ,
        0.00623388],
       [0.0015311 ,        nan, 0.00063949, ..., 0.00626084, 0.00488731,
        0.00605951]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dTdz</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.01436 -0.006534 ... -0.05111</div><input id='attrs-fab2c4f9-0b83-4e7c-b191-481960e55a99' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fab2c4f9-0b83-4e7c-b191-481960e55a99' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f29b35a5-cba2-4501-9374-f3ede6dc22c4' class='xr-var-data-in' type='checkbox'><label for='data-f29b35a5-cba2-4501-9374-f3ede6dc22c4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[-0.01436049, -0.00653449,         nan, ..., -0.00250784,
        -0.00539552, -0.00480507],
       [-0.0045183 , -0.00074501, -0.02194811, ..., -0.00113866,
        -0.0007532 , -0.00129942],
       [-0.00147125, -0.00113696, -0.0088507 , ..., -0.00130473,
        -0.00117747, -0.00065669],
       ...,
       [-0.00044318, -0.00128127, -0.00151285, ..., -0.04254332,
        -0.03989558, -0.05091167],
       [-0.00097999, -0.00117326, -0.00105205, ..., -0.0886238 ,
        -0.07381303, -0.0479083 ],
       [-0.0033632 ,         nan, -0.00162406, ..., -0.06815382,
        -0.05515401, -0.05110799]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>eps</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... 6.178e-09 2.636e-09</div><input id='attrs-dc9e996b-b78b-4d62-836c-fceedc0000e3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dc9e996b-b78b-4d62-836c-fceedc0000e3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d55cf640-8ebb-46fc-b0e7-e2a8107d2b85' class='xr-var-data-in' type='checkbox'><label for='data-d55cf640-8ebb-46fc-b0e7-e2a8107d2b85' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$ε$</dd><dt><span>units :</span></dt><dd>W/kg</dd></dl></div><div class='xr-var-data'><pre>array([[           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       [           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       [           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       ...,
       [6.96240408e-10, 2.39643180e-09, 1.27925802e-09, ...,
        2.97011866e-08,            nan, 5.30762709e-09],
       [3.22168218e-10, 8.85430965e-10, 1.54639088e-09, ...,
        6.88137519e-09, 1.26222122e-07,            nan],
       [           nan,            nan, 3.55171006e-09, ...,
        3.13672119e-09, 6.17819337e-09, 2.63627225e-09]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>EPSILON1</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... 6.572e-09 4.344e-09</div><input id='attrs-079d9636-082b-4921-afb9-56543bfe19d8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-079d9636-082b-4921-afb9-56543bfe19d8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d001f89b-acef-4c42-aa4b-18f481f91ef1' class='xr-var-data-in' type='checkbox'><label for='data-d001f89b-acef-4c42-aa4b-18f481f91ef1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       [           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       [           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       ...,
       [6.96240408e-10, 7.80493785e-10, 1.27925802e-09, ...,
        3.49214176e-08,            nan, 7.25170224e-09],
       [3.22168218e-10, 8.85430965e-10, 1.54639088e-09, ...,
        9.77033274e-09, 1.53937468e-07,            nan],
       [           nan,            nan, 3.55171006e-09, ...,
        2.47166751e-09, 6.57190476e-09, 4.34368847e-09]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>EPSILON2</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... 5.784e-09 9.289e-10</div><input id='attrs-5a52699c-6383-4217-9d67-fbbd44911225' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5a52699c-6383-4217-9d67-fbbd44911225' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f970169d-ed71-466f-9b2f-070543b77d87' class='xr-var-data-in' type='checkbox'><label for='data-f970169d-ed71-466f-9b2f-070543b77d87' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       [           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       [           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       ...,
       [8.66262735e-09, 4.01236982e-09, 7.69519866e-09, ...,
        2.44809556e-08,            nan, 3.36355195e-09],
       [2.55864584e-08, 8.16851488e-09, 2.76931354e-07, ...,
        3.99241764e-09, 9.85067754e-08,            nan],
       [           nan,            nan, 3.34671328e-08, ...,
        3.80177488e-09, 5.78448199e-09, 9.28856029e-10]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>FALLSPD</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>151.0 87.55 nan ... 74.23 73.72</div><input id='attrs-72b62540-da9a-4677-9e3f-db08f546b563' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-72b62540-da9a-4677-9e3f-db08f546b563' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cc583b55-4608-4db1-8afd-d86521e79e40' class='xr-var-data-in' type='checkbox'><label for='data-cc583b55-4608-4db1-8afd-d86521e79e40' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[151.00828562,  87.55099971,          nan, ...,  76.17990955,
         69.74288971,  74.1572544 ],
       [130.62552359, 102.09523562,  75.90970664, ...,  78.56119602,
         67.90846651,  78.7722993 ],
       [117.01893601,  73.17191094,  82.58684812, ...,  82.5993261 ,
         79.59231152, 115.28297341],
       ...,
       [ 70.66059168,  68.89335476,  68.35594549, ...,  73.36311557,
         76.37039051,  72.15674015],
       [ 66.0835682 ,  68.5683379 ,  57.51229511, ...,  73.68654834,
         75.78505871,  72.75590847],
       [ 69.5408982 ,          nan,  64.9369635 , ...,  73.68007403,
         74.23266601,  73.72112265]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>MHT</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>24.46 24.46 nan ... 13.39 13.63</div><input id='attrs-0f0a0671-e35b-4572-a4e0-fc41f496a5a0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0f0a0671-e35b-4572-a4e0-fc41f496a5a0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-196de401-444c-40cd-bc15-33895c5ad3f4' class='xr-var-data-in' type='checkbox'><label for='data-196de401-444c-40cd-bc15-33895c5ad3f4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[24.46305372, 24.46100507,         nan, ..., 25.36078784,
        25.3521449 , 25.33813191],
       [24.46200792, 24.46008954, 24.47812269, ..., 25.36012794,
        25.35119011, 25.33973734],
       [24.4569863 , 24.45968723, 24.45280036, ..., 25.36029728,
        25.34984065, 25.33926874],
       ...,
       [13.50062455, 13.50232187, 13.51214501, ..., 13.49363389,
        13.49803401, 13.7219205 ],
       [13.50205545, 13.50582842, 13.51252495, ..., 13.43453994,
        13.46303391, 13.67271452],
       [13.50169137,         nan, 13.50961328, ..., 13.36115077,
        13.38807874, 13.62652538]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>N2</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... 4.678e-05 5.801e-05</div><input id='attrs-78860ab7-1408-4a86-bd1d-8611939736f6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-78860ab7-1408-4a86-bd1d-8611939736f6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ca4cad57-6d3a-4dfa-a859-dc279b8d28a0' class='xr-var-data-in' type='checkbox'><label for='data-ca4cad57-6d3a-4dfa-a859-dc279b8d28a0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       [           nan, 8.14644408e-06, 5.51824252e-05, ...,
        1.36151824e-05, 1.04319739e-05, 1.27819022e-05],
       [           nan, 7.32403675e-06, 4.47616660e-05, ...,
        8.56950099e-06, 7.91921241e-06, 5.53588213e-06],
       ...,
       [1.52843602e-05, 9.56689133e-06, 6.92781248e-06, ...,
        7.44032795e-05, 5.47807795e-05, 6.77780203e-05],
       [1.39210577e-05, 6.88659760e-06, 8.28652498e-06, ...,
        8.94827089e-05, 8.36648197e-05, 5.96745392e-05],
       [1.46520449e-05,            nan, 6.11957220e-06, ...,
        5.99322176e-05, 4.67774482e-05, 5.80053170e-05]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pres</span></div><div class='xr-var-dims'>(depth)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... 199.3 200.3 201.3</div><input id='attrs-eb38ffbd-061a-4e6d-b6ce-e86cd70df5c9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-eb38ffbd-061a-4e6d-b6ce-e86cd70df5c9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e5f41af2-59f3-4f05-aad9-b625c96cf7ec' class='xr-var-data-in' type='checkbox'><label for='data-e5f41af2-59f3-4f05-aad9-b625c96cf7ec' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>sea_water_pressure</dd><dt><span>units :</span></dt><dd>dbar</dd><dt><span>positive :</span></dt><dd>down</dd></dl></div><div class='xr-var-data'><pre>array([         nan,          nan,          nan,          nan,
                nan,          nan,          nan,          nan,
                nan,  10.05977753,  11.06578229,  12.07178704,
        13.07780079,  14.08381454,  15.0898373 ,  16.09586005,
        17.10189181,  18.10792356,  19.11396431,  20.12000507,
        21.12605483,  22.13210458,  23.13816334,  24.1442221 ,
        25.15028986,  26.15635762,  27.16243438,  28.16851114,
        29.17459691,  30.18068267,  31.18677744,  32.19287221,
        33.19897597,  34.20507974,  35.21119252,  36.21730529,
        37.22342706,  38.22954884,  39.23567962,  40.2418104 ,
        41.24795018,  42.25408996,  43.26023875,  44.26638754,
        45.27254533,  46.27870312,  47.28486992,  48.29103671,
        49.29721251,  50.30338831,  51.30957312,  52.31575792,
        53.32195173,  54.32814554,  55.33434836,  56.34055117,
        57.34676299,  58.35297481,  59.35919564,  60.36541647,
        61.3716463 ,  62.37787614,  63.38411498,  64.39035381,
        65.39660166,  66.40284951,  67.40910636,  68.41536321,
        69.42162907,  70.42789493,  71.4341698 ,  72.44044467,
        73.44672854,  74.45301242,  75.4593053 ,  76.46559818,
        77.47190007,  78.47820197,  79.48451287,  80.49082376,
...
       121.7535441 , 122.76004422, 123.76655337, 124.77306251,
       125.77958067, 126.78609882, 127.792626  , 128.79915317,
       129.80568935, 130.81222554, 131.81877074, 132.82531594,
       133.83187015, 134.83842437, 135.8449876 , 136.85155083,
       137.85812307, 138.86469532, 139.87127658, 140.87785784,
       141.88444812, 142.89103839, 143.89763769, 144.90423698,
       145.91084529, 146.9174536 , 147.92407092, 148.93068825,
       149.93731459, 150.94394093, 151.95057629, 152.95721165,
       153.96385603, 154.9705004 , 155.9771538 , 156.98380719,
       157.9904696 , 158.99713202, 160.00380345, 161.01047488,
       162.01715532, 163.02383577, 164.03052524, 165.0372147 ,
       166.04391319, 167.05061168, 168.05731918, 169.06402668,
       170.07074321, 171.07745973, 172.08418527, 173.09091082,
       174.09764538, 175.10437994, 176.11112352, 177.11786711,
       178.12461971, 179.13137231, 180.13813393, 181.14489556,
       182.1516662 , 183.15843684, 184.16521651, 185.17199617,
       186.17878486, 187.18557355, 188.19237125, 189.19916896,
       190.20597569, 191.21278242, 192.21959817, 193.22641392,
       194.23323869, 195.24006346, 196.24689726, 197.25373105,
       198.26057387, 199.26741669, 200.27426853, 201.28112037])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>salt</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>34.94 35.3 nan ... 34.93 34.96</div><input id='attrs-ed11d3e7-5255-4d86-81d5-8ba3eadde27b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ed11d3e7-5255-4d86-81d5-8ba3eadde27b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f9e0f14b-5b45-449a-97b1-ea9af1edf93a' class='xr-var-data-in' type='checkbox'><label for='data-f9e0f14b-5b45-449a-97b1-ea9af1edf93a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>sea_water_salinity</dd><dt><span>units :</span></dt><dd>psu</dd></dl></div><div class='xr-var-data'><pre>array([[34.94362771, 35.30018723,         nan, ..., 34.868444  ,
        34.8650583 , 34.86358481],
       [35.01189375, 35.30135259, 35.30534243, ..., 34.86986907,
        34.86369895, 34.86308693],
       [35.05344093, 35.30136575, 35.30479666, ..., 34.86942459,
        34.86449071, 34.86371585],
       ...,
       [34.9961638 , 35.02097547, 35.0206923 , ..., 34.94485747,
        34.94327127, 34.96990918],
       [34.99843771, 35.02305751, 35.0219565 , ..., 34.9378472 ,
        34.93829672, 34.96477563],
       [35.00050735,         nan, 35.02210145, ..., 34.92858079,
        34.92865856, 34.95861769]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SCAT</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.03219 0.036 ... 0.005352</div><input id='attrs-e393e9db-41d9-4681-821b-af6ce9f458dc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e393e9db-41d9-4681-821b-af6ce9f458dc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c75951d1-6229-4166-88d7-f8d89c9094c2' class='xr-var-data-in' type='checkbox'><label for='data-c75951d1-6229-4166-88d7-f8d89c9094c2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[-0.03219156,  0.03600432,         nan, ...,  0.01710055,
         0.01616957,  0.01663473],
       [ 0.04302521,  0.03128198,  0.05182841, ...,  0.01705586,
         0.01602668,  0.01624286],
       [ 0.03141643,  0.03285947,  0.02906282, ...,  0.01773346,
         0.01610342,  0.01557437],
       ...,
       [ 0.00804034,  0.00829834,  0.0088503 , ...,  0.00658199,
         0.0055813 ,  0.0061264 ],
       [ 0.00886397,  0.0085968 ,  0.00859985, ...,  0.00673109,
         0.00553154,  0.00584433],
       [ 0.00918435,         nan,  0.00883484, ...,  0.00619573,
         0.00552144,  0.00535185]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pden</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>23.46 23.73 nan ... 26.26 26.23</div><input id='attrs-6047e919-22db-4180-a0a2-171d8f43197b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6047e919-22db-4180-a0a2-171d8f43197b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6869c8eb-a7d6-4921-a3ec-9b8054413ebe' class='xr-var-data-in' type='checkbox'><label for='data-6869c8eb-a7d6-4921-a3ec-9b8054413ebe' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>sea_water_potential_density</dd></dl></div><div class='xr-var-data'><pre>array([[23.46079877, 23.73118907,         nan, ..., 23.13170869,
        23.13144901, 23.1343855 ],
       [23.51281944, 23.73242705, 23.72997437, ..., 23.13317038,
        23.130685  , 23.13325879],
       [23.54584534, 23.7326024 , 23.73726036, ..., 23.13302863,
        23.13204943, 23.13408967],
       ...,
       [26.29388507, 26.31276261, 26.31051514, ..., 26.25056649,
        26.24845687, 26.22231475],
       [26.2953958 , 26.31367257, 26.31144044, ..., 26.25840607,
        26.25139929, 26.22865568],
       [26.29708919,         nan, 26.31218545, ..., 26.26601839,
        26.26096781, 26.23375296]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SIGMA_ORDER</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>23.46 23.73 nan ... 26.26 26.23</div><input id='attrs-1dac3f4c-48d7-4d11-b64f-bf02ee9bb002' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1dac3f4c-48d7-4d11-b64f-bf02ee9bb002' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3a39ac8f-0bb0-431b-90d7-11a5e9d93ac5' class='xr-var-data-in' type='checkbox'><label for='data-3a39ac8f-0bb0-431b-90d7-11a5e9d93ac5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[23.46079877, 23.72994449,         nan, ..., 23.12907814,
        23.12751084, 23.13021108],
       [23.51281944, 23.73178664, 23.72967916, ..., 23.13106028,
        23.13011005, 23.13260374],
       [23.54579849, 23.73259442, 23.73658222, ..., 23.13226611,
        23.13099216, 23.13356356],
       ...,
       [26.29391253, 26.31245867, 26.31066739, ..., 26.25068981,
        26.24716886, 26.22187649],
       [26.29539223, 26.31333338, 26.31141875, ..., 26.26007178,
        26.25431434, 26.22811577],
       [26.29703015,         nan, 26.31220693, ..., 26.26697105,
        26.26086833, 26.23444197]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>T</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>24.46 24.46 nan ... 13.41 13.65</div><input id='attrs-8158e976-dad7-49f1-aa8a-f14520ca4a24' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8158e976-dad7-49f1-aa8a-f14520ca4a24' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5f18e755-889f-4d3a-adc0-6a14fde3e7fd' class='xr-var-data-in' type='checkbox'><label for='data-5f18e755-889f-4d3a-adc0-6a14fde3e7fd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>sea_water_temperature</dd><dt><span>units :</span></dt><dd>celsius</dd></dl></div><div class='xr-var-data'><pre>array([[24.46305372, 24.46100507,         nan, ..., 25.3610658 ,
        25.35365741, 25.34037405],
       [24.46200792, 24.46008954, 24.47812269, ..., 25.36012153,
        25.35296163, 25.34318247],
       [24.4569863 , 24.45968723, 24.45280036, ..., 25.35969708,
        25.35054625, 25.34207569],
       ...,
       [13.50062455, 13.50232187, 13.51214501, ..., 13.51782868,
        13.52213554, 13.74865422],
       [13.50205545, 13.50582842, 13.51252495, ..., 13.45309267,
        13.48906756, 13.69895042],
       [13.50169137,         nan, 13.50961328, ..., 13.38095109,
        13.40600394, 13.65149054]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>theta</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>24.46 24.46 nan ... 13.38 13.62</div><input id='attrs-13d14e11-4212-4c57-a314-5ce06e275250' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-13d14e11-4212-4c57-a314-5ce06e275250' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a02b310d-3dfb-469f-a300-69e6b6c053a1' class='xr-var-data-in' type='checkbox'><label for='data-a02b310d-3dfb-469f-a300-69e6b6c053a1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>sea_water_potential_temperature</dd><dt><span>units :</span></dt><dd>celsius</dd></dl></div><div class='xr-var-data'><pre>array([[24.46278633, 24.46063465,         nan, ..., 25.36068714,
        25.35319496, 25.33998547],
       [24.46151771, 24.45944798, 24.47766789, ..., 25.35943028,
        25.35233837, 25.34243463],
       [24.45619486, 24.45889705, 24.45202756, ..., 25.35879783,
        25.34983834, 25.34127356],
       ...,
       [13.47251088, 13.47410045, 13.48396391, ..., 13.49006132,
        13.4943517 , 13.72050601],
       [13.47372367, 13.47751251, 13.48422246, ..., 13.42541699,
        13.46128742, 13.67083078],
       [13.47327859,         nan, 13.48114564, ..., 13.35317935,
        13.37818752, 13.623216  ]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>TP</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.05732 -0.1281 ... -0.2242</div><input id='attrs-eec392e4-e4ea-44d1-b1e6-42c0841e7e1e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-eec392e4-e4ea-44d1-b1e6-42c0841e7e1e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ab9688a0-8f3c-4157-ae72-2757c2df8647' class='xr-var-data-in' type='checkbox'><label for='data-ab9688a0-8f3c-4157-ae72-2757c2df8647' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[-0.05732082, -0.12806134,         nan, ..., -0.34024153,
        -0.38133369, -0.35699119],
       [-0.06546212, -0.10659246, -0.12307135, ..., -0.3333159 ,
        -0.39425575, -0.33758929],
       [-0.09443323, -0.1496652 , -0.12297793, ..., -0.31555584,
        -0.32933023, -0.2271127 ],
       ...,
       [-0.15774034, -0.15947967, -0.15325446, ..., -0.22580624,
        -0.21021137, -0.23267882],
       [-0.16892777, -0.16270043, -0.17399235, ..., -0.18181915,
        -0.20189618, -0.23372138],
       [-0.15988141,         nan, -0.15394087, ..., -0.19740331,
        -0.20391061, -0.2242284 ]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>VARAZ</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.01526 0.1148 ... 2.865e-05</div><input id='attrs-e64049d7-507c-4b82-aeca-314990a476bf' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e64049d7-507c-4b82-aeca-314990a476bf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b3bfd7c3-678f-431b-8799-d66150ffe579' class='xr-var-data-in' type='checkbox'><label for='data-b3bfd7c3-678f-431b-8799-d66150ffe579' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1.52602418e-02, 1.14751343e-01,            nan, ...,
        4.02707158e-03, 1.26779431e-03, 1.94311300e-03],
       [7.53892496e-04, 2.00504458e-03, 3.85083934e-02, ...,
        2.29083345e-04, 1.03864267e-03, 6.43673104e-03],
       [6.84868257e-04, 1.34684176e-03, 1.71323974e-03, ...,
        1.37456947e-03, 5.27676767e-05, 2.11826561e-03],
       ...,
       [2.44678856e-05, 4.22474786e-05, 4.03787243e-05, ...,
        6.00316466e-05, 2.47364433e-05, 2.90673534e-05],
       [4.42878405e-05, 8.45998778e-05, 3.78838594e-04, ...,
        4.82540893e-05, 4.45965295e-05, 2.89847535e-05],
       [1.11132363e-05,            nan, 1.73453867e-05, ...,
        4.93399561e-05, 1.95433878e-05, 2.86516307e-05]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>VARLT</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.361e-05 1.753 ... 0.7802 0.3874</div><input id='attrs-4a78e193-f001-4e18-b8e7-8bb370e4c9a7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4a78e193-f001-4e18-b8e7-8bb370e4c9a7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3d58684c-71fd-41d4-960a-898a226a9d55' class='xr-var-data-in' type='checkbox'><label for='data-3d58684c-71fd-41d4-960a-898a226a9d55' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[5.36054311e-05, 1.75328968e+00,            nan, ...,
        9.85368494e+00, 1.18728748e+01, 2.62870531e+01],
       [1.18968850e-03, 1.65453874e+00, 1.21096835e-01, ...,
        1.59476156e+01, 4.68682661e+00, 1.06384071e+01],
       [4.28472491e-03, 9.01488398e-01, 6.87824149e-01, ...,
        1.32801234e+01, 7.24044305e+00, 1.13660636e+01],
       ...,
       [1.93831484e-01, 1.20038823e+00, 1.05940402e+00, ...,
        3.74231044e-01, 7.11895376e-01, 2.15198220e-01],
       [2.20486469e-01, 6.75165881e-01, 1.18609776e+00, ...,
        1.68356707e+00, 2.48437694e+00, 3.91133820e-01],
       [1.77632139e-01,            nan, 7.93734910e-01, ...,
        3.67721266e-01, 7.80181699e-01, 3.87390154e-01]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>u</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-7e42308b-3a67-44e2-84e1-5f8298d7adfd' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7e42308b-3a67-44e2-84e1-5f8298d7adfd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3877acd5-1349-45e3-99ae-775df8ba5be7' class='xr-var-data-in' type='checkbox'><label for='data-3877acd5-1349-45e3-99ae-775df8ba5be7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>v</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-e84d21eb-eb4a-4469-8d63-51f7cd148bb7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e84d21eb-eb4a-4469-8d63-51f7cd148bb7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-695a6475-cf29-4d24-9aaf-8a86b6bcd2b8' class='xr-var-data-in' type='checkbox'><label for='data-695a6475-cf29-4d24-9aaf-8a86b6bcd2b8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dudz</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-52f2bd69-672b-49ef-b41f-d05d95d96a06' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-52f2bd69-672b-49ef-b41f-d05d95d96a06' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a6ba4ca4-b055-4fc0-a06e-fcf01b37a262' class='xr-var-data-in' type='checkbox'><label for='data-a6ba4ca4-b055-4fc0-a06e-fcf01b37a262' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dvdz</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-bffd3626-d765-40c6-b80b-1e5fae1d8590' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bffd3626-d765-40c6-b80b-1e5fae1d8590' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fde4abe3-4e8f-4fc8-868a-f73348a2a870' class='xr-var-data-in' type='checkbox'><label for='data-fde4abe3-4e8f-4fc8-868a-f73348a2a870' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Sh2</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-b735677a-b744-4510-88fe-69544428b055' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b735677a-b744-4510-88fe-69544428b055' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-04d51809-8b75-443c-bad9-835435f0d9af' class='xr-var-data-in' type='checkbox'><label for='data-04d51809-8b75-443c-bad9-835435f0d9af' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sortT</span></div><div class='xr-var-dims'>(time, depth)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>24.46 24.46 24.46 ... 13.67 13.62</div><input id='attrs-e9c7ccb1-0548-468b-a78a-aed578745f34' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e9c7ccb1-0548-468b-a78a-aed578745f34' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-de084110-18bc-4d76-9cf7-c2a3dd279883' class='xr-var-data-in' type='checkbox'><label for='data-de084110-18bc-4d76-9cf7-c2a3dd279883' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>sea_water_potential_temperature</dd><dt><span>units :</span></dt><dd>celsius</dd></dl></div><div class='xr-var-data'><pre>array([[24.46278633, 24.46151771, 24.45619486, ..., 13.47251088,
        13.47372367, 13.47327859],
       [24.46063465, 24.45944798, 24.45889705, ..., 13.47410045,
        13.47751251,         nan],
       [        nan, 24.47766789, 24.45202756, ..., 13.48396391,
        13.48422246, 13.48114564],
       ...,
       [25.36068714, 25.35879783, 25.35943028, ..., 13.49006132,
        13.42541699, 13.35317935],
       [25.35233837, 25.35319496, 25.34880503, ..., 13.4943517 ,
        13.46128742, 13.37818752],
       [25.34243463, 25.34018605, 25.34127356, ..., 13.72050601,
        13.67083078, 13.623216  ]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sortTbyT</span></div><div class='xr-var-dims'>(time, depth)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>24.47 24.46 24.46 ... 13.67 13.62</div><input id='attrs-3bfc69b3-e6f3-4915-b4b2-234360e1d534' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3bfc69b3-e6f3-4915-b4b2-234360e1d534' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f0bfd3f7-1595-4d60-b3c8-847af92fa438' class='xr-var-data-in' type='checkbox'><label for='data-f0bfd3f7-1595-4d60-b3c8-847af92fa438' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>sea_water_potential_temperature</dd><dt><span>units :</span></dt><dd>celsius</dd></dl></div><div class='xr-var-data'><pre>array([[24.46590019, 24.46278633, 24.46151771, ..., 13.47372367,
        13.47327859, 13.47251088],
       [24.46063465, 24.45944798, 24.45889705, ..., 13.47331599,
        13.47167783,         nan],
       [        nan, 24.47766789, 24.45202756, ..., 13.47512686,
        13.47161123, 13.47133952],
       ...,
       [25.36068714, 25.35943028, 25.35879783, ..., 13.49006132,
        13.42541699, 13.35317935],
       [25.35319496, 25.35233837, 25.34983834, ..., 13.4943517 ,
        13.46128742, 13.37818752],
       [25.34243463, 25.34127356, 25.34018605, ..., 13.72050601,
        13.67083078, 13.623216  ]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Jq</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... -5.973 -1.905</div><input id='attrs-8a62bf5e-8e54-4d58-844e-7d159efc374c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8a62bf5e-8e54-4d58-844e-7d159efc374c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5fceee17-5cc8-482c-a56d-8d3cb0648a85' class='xr-var-data-in' type='checkbox'><label for='data-5fceee17-5cc8-482c-a56d-8d3cb0648a85' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$J_q^ε$</dd><dt><span>units :</span></dt><dd>W/m²</dd></dl></div><div class='xr-var-data'><pre>array([[            nan,             nan,             nan, ...,
                    nan,             nan,             nan],
       [            nan,             nan,             nan, ...,
                    nan,             nan,             nan],
       [            nan,             nan,             nan, ...,
                    nan,             nan,             nan],
       ...,
       [-1.65541848e-02, -2.63178099e-01, -2.29072395e-01, ...,
        -1.39260184e+01,             nan, -3.26920935e+00],
       [-1.85971723e-02, -1.23696694e-01, -1.60989824e-01, ...,
        -5.58856543e+00, -9.13144432e+01,             nan],
       [            nan,             nan, -7.72916698e-01, ...,
        -2.92495788e+00, -5.97332141e+00, -1.90469368e+00]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dJdz</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan</div><input id='attrs-183cabdb-899b-479d-b1cc-fe08824ff66d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-183cabdb-899b-479d-b1cc-fe08824ff66d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f9ee8472-7836-4037-8b40-423dfc2c288e' class='xr-var-data-in' type='checkbox'><label for='data-f9ee8472-7836-4037-8b40-423dfc2c288e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$∂J_q^ε/∂z$</dd><dt><span>units :</span></dt><dd>W/kg/m</dd></dl></div><div class='xr-var-data'><pre>array([[        nan,         nan,         nan, ...,         nan,
                nan,         nan],
       [        nan,         nan,         nan, ...,         nan,
                nan,         nan],
       [        nan,         nan,         nan, ...,         nan,
                nan,         nan],
       ...,
       [-0.0187685 ,  0.00877046,  0.06694358, ..., -0.23210104,
        -6.13055354,  0.11571491],
       [-0.01194092,  0.01379614,  0.14696166, ..., -0.86978889,
        -7.4125274 , -0.15578411],
       [        nan,         nan,  0.17123272, ...,         nan,
                nan,         nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dTdt</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan</div><input id='attrs-1e48e674-1818-4de0-9612-6010d7f724fd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1e48e674-1818-4de0-9612-6010d7f724fd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-62ab52a4-a7d5-4bc0-8526-4ae022aaf23c' class='xr-var-data-in' type='checkbox'><label for='data-62ab52a4-a7d5-4bc0-8526-4ae022aaf23c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$∂T/∂t = -1/(ρ_0c_p) ∂J_q^ε/∂z$</dd><dt><span>units :</span></dt><dd>°C/month</dd></dl></div><div class='xr-var-data'><pre>array([[        nan,         nan,         nan, ...,         nan,
                nan,         nan],
       [        nan,         nan,         nan, ...,         nan,
                nan,         nan],
       [        nan,         nan,         nan, ...,         nan,
                nan,         nan],
       ...,
       [ 0.01186535, -0.00554464, -0.0423214 , ...,  0.14673314,
         3.87570604, -0.0731544 ],
       [ 0.00754899, -0.00872185, -0.09290844, ...,  0.54987629,
         4.68616366,  0.09848595],
       [        nan,         nan, -0.10825249, ...,         nan,
                nan,         nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>eucmax</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-2b55de57-0f5b-4b0a-985c-f1ec94af2905' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2b55de57-0f5b-4b0a-985c-f1ec94af2905' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-51b92e0d-ad55-4bfe-9be1-2e08ed525b18' class='xr-var-data-in' type='checkbox'><label for='data-51b92e0d-ad55-4bfe-9be1-2e08ed525b18' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>long_name :</span></dt><dd>Depth of EUC max</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([nan, nan, nan, ..., nan, nan, nan])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>mld</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.0 6.0 3.0 9.0 ... 13.0 9.0 12.0</div><input id='attrs-6eac8eb8-e29d-43b3-bca6-39f4d4a1f8d4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6eac8eb8-e29d-43b3-bca6-39f4d4a1f8d4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d9fea844-7568-4c9e-b738-4034f95f6082' class='xr-var-data-in' type='checkbox'><label for='data-d9fea844-7568-4c9e-b738-4034f95f6082' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>MLD</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>description :</span></dt><dd>Interpolate density to 1m grid. Search for min depth where  |drho| &gt; 0.005 and N2 &gt; 1e-08</dd></dl></div><div class='xr-var-data'><pre>array([ 2.,  6.,  3., ..., 13.,  9., 12.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Jq_euc</span></div><div class='xr-var-dims'>(time, zeuc)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-5f67e8b5-fa56-42e7-b86a-796f76dcd65a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5f67e8b5-fa56-42e7-b86a-796f76dcd65a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-404178c4-f52f-4526-99f9-7c1d9b0b32a8' class='xr-var-data-in' type='checkbox'><label for='data-404178c4-f52f-4526-99f9-7c1d9b0b32a8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$J_q^ε$</dd><dt><span>units :</span></dt><dd>W/m²</dd></dl></div><div class='xr-var-data'><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dJdz_euc</span></div><div class='xr-var-dims'>(time, zeuc)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-59728b1a-20b2-49a4-8716-2dbd5bf7a02d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-59728b1a-20b2-49a4-8716-2dbd5bf7a02d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6add04cc-5990-4fa0-8673-6bab518c6359' class='xr-var-data-in' type='checkbox'><label for='data-6add04cc-5990-4fa0-8673-6bab518c6359' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$∂J_q^ε/∂z$</dd><dt><span>units :</span></dt><dd>W/kg/m</dd></dl></div><div class='xr-var-data'><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dTdt_euc</span></div><div class='xr-var-dims'>(time, zeuc)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-bdddbc03-8396-412f-b250-5f9f4bfdac61' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bdddbc03-8396-412f-b250-5f9f4bfdac61' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7727a152-d3ed-41f8-88a1-bbb5e08591aa' class='xr-var-data-in' type='checkbox'><label for='data-7727a152-d3ed-41f8-88a1-bbb5e08591aa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$∂T/∂t = -1/(ρ_0c_p) ∂J_q^ε/∂z$</dd><dt><span>units :</span></dt><dd>°C/month</dd></dl></div><div class='xr-var-data'><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>u_euc</span></div><div class='xr-var-dims'>(time, zeuc)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-c1c66652-0f18-42fd-b1e3-080d321c7a73' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c1c66652-0f18-42fd-b1e3-080d321c7a73' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ea57aea5-3318-4c2d-860e-dce4900f7a6b' class='xr-var-data-in' type='checkbox'><label for='data-ea57aea5-3318-4c2d-860e-dce4900f7a6b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>depth_euc</span></div><div class='xr-var-dims'>(time, zeuc)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-0a88e1c9-a928-4e3d-9497-fa5bd069bc2e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0a88e1c9-a928-4e3d-9497-fa5bd069bc2e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4616efe0-b0c6-4b5f-a5b0-e7a2a18a7a9a' class='xr-var-data-in' type='checkbox'><label for='data-4616efe0-b0c6-4b5f-a5b0-e7a2a18a7a9a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd></dl></div><div class='xr-var-data'><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>count_Jq_euc</span></div><div class='xr-var-dims'>(time, zeuc)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0</div><input id='attrs-c3d6cc25-5ed5-44ac-a067-026141447207' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c3d6cc25-5ed5-44ac-a067-026141447207' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4f255895-a6a6-409d-a264-ccb6002e01d4' class='xr-var-data-in' type='checkbox'><label for='data-4f255895-a6a6-409d-a264-ccb6002e01d4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$J_q^ε$</dd><dt><span>units :</span></dt><dd>W/m²</dd></dl></div><div class='xr-var-data'><pre>array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>count_dJdz_euc</span></div><div class='xr-var-dims'>(time, zeuc)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0</div><input id='attrs-7744dc19-26f0-4acc-ab18-1421d0e37319' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7744dc19-26f0-4acc-ab18-1421d0e37319' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-200354de-f3ca-4ff8-ac66-e6b30813632a' class='xr-var-data-in' type='checkbox'><label for='data-200354de-f3ca-4ff8-ac66-e6b30813632a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$∂J_q^ε/∂z$</dd><dt><span>units :</span></dt><dd>W/kg/m</dd></dl></div><div class='xr-var-data'><pre>array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>count_dTdt_euc</span></div><div class='xr-var-dims'>(time, zeuc)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0</div><input id='attrs-f66d9a9b-d47a-44c8-b136-c6da8eb53a13' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f66d9a9b-d47a-44c8-b136-c6da8eb53a13' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fc4175e9-515c-45c5-b189-09f430e1204d' class='xr-var-data-in' type='checkbox'><label for='data-fc4175e9-515c-45c5-b189-09f430e1204d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$∂T/∂t = -1/(ρ_0c_p) ∂J_q^ε/∂z$</dd><dt><span>units :</span></dt><dd>°C/month</dd></dl></div><div class='xr-var-data'><pre>array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>count_u_euc</span></div><div class='xr-var-dims'>(time, zeuc)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0</div><input id='attrs-279cf919-c05f-445c-a472-3ffa68ca04b9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-279cf919-c05f-445c-a472-3ffa68ca04b9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c829f611-cacc-4fa4-bcb9-f2238740dd01' class='xr-var-data-in' type='checkbox'><label for='data-c829f611-cacc-4fa4-bcb9-f2238740dd01' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>count_depth_euc</span></div><div class='xr-var-dims'>(time, zeuc)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0</div><input id='attrs-0db246a1-bb41-4d85-9364-b45200f65e55' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0db246a1-bb41-4d85-9364-b45200f65e55' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-307958c5-f662-495e-aaec-d25d2e4e0a42' class='xr-var-data-in' type='checkbox'><label for='data-307958c5-f662-495e-aaec-d25d2e4e0a42' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd></dl></div><div class='xr-var-data'><pre>array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>NT2</span></div><div class='xr-var-dims'>(depth, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... 0.0001089 0.000102</div><input id='attrs-0cea7c7d-49bb-43ae-9bf2-2ea19ca89ff5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0cea7c7d-49bb-43ae-9bf2-2ea19ca89ff5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1fc6afa7-e96f-43ce-89e7-dc3c1a56ec77' class='xr-var-data-in' type='checkbox'><label for='data-1fc6afa7-e96f-43ce-89e7-dc3c1a56ec77' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>sea_water_potential_temperature</dd><dt><span>units :</span></dt><dd>degC</dd><dt><span>long_name :</span></dt><dd>$θ$</dd></dl></div><div class='xr-var-data'><pre>array([[           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       [           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       [           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       ...,
       [8.78678055e-07, 2.54051069e-06, 3.00104213e-06, ...,
        8.44165512e-05, 7.91782863e-05, 1.02082515e-04],
       [1.94325601e-06, 2.32689557e-06, 2.08714961e-06, ...,
        1.75346426e-04, 1.46282834e-04, 9.58533486e-05],
       [6.66940806e-06,            nan, 3.22175624e-06, ...,
        1.34409516e-04, 1.08897277e-04, 1.02043547e-04]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d7ccb1d9-7d35-4712-9ec2-914eaa622d10' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d7ccb1d9-7d35-4712-9ec2-914eaa622d10' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>starttime :</span></dt><dd>[&#x27;Time:20:34:29 298   &#x27; &#x27;Time:20:42:18 298   &#x27; &#x27;Time:20:52:14 298   &#x27; ...
 &#x27;Time:18:56:50 313   &#x27; &#x27;Time:19:04:01 313   &#x27; &#x27;Time:19:11:46 313   &#x27;]</dd><dt><span>endtime :</span></dt><dd>[&#x27;Time:20:38:29 298   &#x27; &#x27;Time:20:46:29 298   &#x27; &#x27;Time:20:56:29 298   &#x27; ...
 &#x27;Time:19:01:00 313   &#x27; &#x27;Time:19:08:40 313   &#x27; &#x27;Time:19:16:00 313   &#x27;]</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>There are some masks applied in XXX.m, I think the dataset I have has those masks applied.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># badmask = (cham.VARAZ &gt; 0.01) &amp; (np.log10(cham.AZ2) &gt; -4.5) &amp; (cham.eps &gt; 1e-4)</span>
<span class="c1"># cham = cham.where(~badmask)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tao</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/work/datasets/microstructure/osu/equix/hourly_tao.nc&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">iop</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/datasets/microstructure/osu/equix/hourly_iop.nc&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">eop</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/datasets/microstructure/osu/equix/hourly_eop.nc&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">tao_iop</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/datasets/microstructure/osu/equix/hourly_tao_iop.nc&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">suffix</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">]:</span>
    <span class="n">tao_iop</span><span class="p">[</span><span class="s2">&quot;NT2&quot;</span> <span class="o">+</span> <span class="n">suffix</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mf">9.81</span>
        <span class="o">*</span> <span class="n">dcpy</span><span class="o">.</span><span class="n">eos</span><span class="o">.</span><span class="n">alpha</span><span class="p">(</span>
            <span class="mi">34</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">tao_iop</span><span class="p">[</span><span class="s2">&quot;T1&quot;</span><span class="p">]),</span>
            <span class="n">tao_iop</span><span class="p">[</span><span class="s2">&quot;T&quot;</span> <span class="o">+</span> <span class="n">suffix</span><span class="p">],</span>
            <span class="n">tao_iop</span><span class="o">.</span><span class="n">depth</span><span class="o">.</span><span class="n">broadcast_like</span><span class="p">(</span><span class="n">tao_iop</span><span class="o">.</span><span class="n">T1</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="o">*</span> <span class="n">tao_iop</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;dT</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">dz&quot;</span><span class="p">]</span>
    <span class="p">)</span>

<span class="n">iop</span><span class="p">[</span><span class="s2">&quot;NT2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="mf">9.81</span> <span class="o">*</span> <span class="n">dcpy</span><span class="o">.</span><span class="n">eos</span><span class="o">.</span><span class="n">alpha</span><span class="p">(</span><span class="mi">34</span> <span class="o">*</span> <span class="n">xr</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">iop</span><span class="o">.</span><span class="n">theta</span><span class="p">),</span> <span class="n">iop</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span> <span class="n">iop</span><span class="o">.</span><span class="n">depth</span><span class="p">)</span> <span class="o">*</span> <span class="n">iop</span><span class="o">.</span><span class="n">dTdz</span>
<span class="p">)</span>

<span class="n">Tbins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
    <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mf">26.1</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">cham</span><span class="o">.</span><span class="n">dTdz</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<span class="c1"># mask = (np.abs(cham.dTdz) &gt; 1e-3) &amp; (cham.N2 &gt; 1e-5)</span>
<span class="p">(</span><span class="n">cham</span><span class="o">.</span><span class="n">chi</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">cham</span><span class="o">.</span><span class="n">dTdz</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="p">(</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">cham</span><span class="o">.</span><span class="n">eps</span> <span class="o">/</span> <span class="n">cham</span><span class="o">.</span><span class="n">N2</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fdc9c7755b0&gt;]
</pre></div>
</div>
<img alt="_images/equix-examine_8_1.png" src="_images/equix-examine_8_1.png" />
</div>
</div>
<div class="section" id="test-thorpe-sorting">
<h2>Test thorpe sorting<a class="headerlink" href="#test-thorpe-sorting" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2008-11-03 04:00:00&quot;</span><span class="p">)</span>

<span class="n">profile</span> <span class="o">=</span> <span class="n">cham</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="p">[</span><span class="n">time</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">)</span>
<span class="n">profile</span><span class="o">.</span><span class="n">theta</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="n">thorpesort</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span> <span class="n">profile</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
<span class="n">thorpesort</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span> <span class="n">profile</span><span class="o">.</span><span class="n">pden</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2008-11-03 04:00:00&quot;</span><span class="p">)</span>

<span class="n">theta_old</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">theta_old</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
<span class="n">cham</span><span class="o">.</span><span class="n">theta</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;^&quot;</span><span class="p">)</span>
<span class="n">cham</span><span class="o">.</span><span class="n">sortT</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">cham</span><span class="o">.</span><span class="n">sortTbyT</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="sorting-and-calculating-gradients">
<h2>Sorting and calculating gradients<a class="headerlink" href="#sorting-and-calculating-gradients" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Trying to replicate Sasha’s dT/dz</p></li>
<li><p>Sasha’s dT/dz looks like he’s sorted <span class="math notranslate nohighlight">\(T\)</span> by <span class="math notranslate nohighlight">\(T\)</span>, instead of <span class="math notranslate nohighlight">\(ρ\)</span>, but I still have trouble replicating. Note he has no negative values.</p></li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre">cali_eq08.m</span></code> is useful. <code class="docutils literal notranslate"><span class="pre">SIGMA_ORDER</span></code> and <code class="docutils literal notranslate"><span class="pre">THETA_ORDER</span></code> are thorpesorted by <code class="docutils literal notranslate"><span class="pre">calc_order</span></code></p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% calculate SIGMA_ORDER</span><span class="w"></span>
<span class="n">inds</span><span class="p">=</span><span class="n">calc_order</span><span class="p">(</span><span class="s">&#39;sigma&#39;</span><span class="p">,</span><span class="s">&#39;P&#39;</span><span class="p">);</span><span class="w"></span>
<span class="c">% calculate THETA_ORDER</span><span class="w"></span>
<span class="n">inds</span><span class="p">=</span><span class="n">calc_order</span><span class="p">(</span><span class="s">&#39;theta&#39;</span><span class="p">,</span><span class="s">&#39;P&#39;</span><span class="p">);</span><span class="w"></span>

<span class="c">% calculate the mean temperature gradient on small scales:</span><span class="w"></span>
<span class="n">cal</span><span class="p">.</span><span class="n">DTDZ</span><span class="p">=</span><span class="nb">diff</span><span class="p">(</span><span class="n">cal</span><span class="p">.</span><span class="n">THETA_ORDER</span><span class="p">)</span><span class="o">./</span><span class="nb">diff</span><span class="p">(</span><span class="n">cal</span><span class="p">.</span><span class="n">P</span><span class="p">);</span><span class="w"></span>
<span class="n">cal</span><span class="p">.</span><span class="n">DTDZ</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">cal</span><span class="p">.</span><span class="n">DTDZ</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)=</span><span class="n">cal</span><span class="p">.</span><span class="n">DTDZ</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">cal</span><span class="p">.</span><span class="n">DTDZ</span><span class="p">));</span><span class="w"></span>
<span class="nb">head</span><span class="p">.</span><span class="n">irep</span><span class="p">.</span><span class="n">DTDZ</span><span class="p">=</span><span class="mi">1</span><span class="p">;</span><span class="w"></span>

<span class="c">% calculate the mean density gradient on small scales:</span><span class="w"></span>
<span class="n">cal</span><span class="p">.</span><span class="n">DRHODZ</span><span class="p">=</span><span class="nb">diff</span><span class="p">(</span><span class="n">cal</span><span class="p">.</span><span class="n">SIGMA_ORDER</span><span class="p">)</span><span class="o">./</span><span class="nb">diff</span><span class="p">(</span><span class="n">cal</span><span class="p">.</span><span class="n">P</span><span class="p">);</span><span class="w"></span>
<span class="n">cal</span><span class="p">.</span><span class="n">DRHODZ</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">cal</span><span class="p">.</span><span class="n">DRHODZ</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)=</span><span class="n">cal</span><span class="p">.</span><span class="n">DRHODZ</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">cal</span><span class="p">.</span><span class="n">DRHODZ</span><span class="p">));</span><span class="w"></span>
<span class="nb">head</span><span class="p">.</span><span class="n">irep</span><span class="p">.</span><span class="n">DRHODZ</span><span class="p">=</span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="n">g</span><span class="p">=</span><span class="mf">9.81</span><span class="p">;</span><span class="w"></span>
<span class="n">cal</span><span class="p">.</span><span class="n">SIGMA</span><span class="p">=</span><span class="n">cal</span><span class="p">.</span><span class="n">SIGMA</span><span class="o">-</span><span class="mi">1000</span><span class="p">;</span><span class="w"></span>
<span class="n">cal</span><span class="p">.</span><span class="n">SIGMA_ORDER</span><span class="p">=</span><span class="n">cal</span><span class="p">.</span><span class="n">SIGMA_ORDER</span><span class="o">-</span><span class="mi">1000</span><span class="p">;</span><span class="w"></span>
<span class="n">rhoav</span><span class="p">=</span><span class="nb">mean</span><span class="p">(</span><span class="n">cal</span><span class="p">.</span><span class="n">SIGMA</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">cal</span><span class="p">.</span><span class="n">SIGMA</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="mi">1000</span><span class="p">;</span><span class="w"></span>

<span class="n">cal</span><span class="p">.</span><span class="n">N2</span><span class="p">=(</span><span class="n">g</span><span class="o">/</span><span class="n">rhoav</span><span class="p">)</span><span class="o">.*</span><span class="nb">diff</span><span class="p">(</span><span class="n">cal</span><span class="p">.</span><span class="n">SIGMA_ORDER</span><span class="p">)</span><span class="o">./</span><span class="nb">diff</span><span class="p">(</span><span class="n">cal</span><span class="p">.</span><span class="n">P</span><span class="p">);</span><span class="w"></span>
<span class="n">cal</span><span class="p">.</span><span class="n">N2</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">cal</span><span class="p">.</span><span class="n">N2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)=</span><span class="n">cal</span><span class="p">.</span><span class="n">N2</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">cal</span><span class="p">.</span><span class="n">N2</span><span class="p">));</span><span class="w"></span>
</pre></div>
</div>
<p>This confirms that <code class="docutils literal notranslate"><span class="pre">THETA</span></code> is sorted by <code class="docutils literal notranslate"><span class="pre">THETA</span></code> and <code class="docutils literal notranslate"><span class="pre">SIGMA</span></code> by <code class="docutils literal notranslate"><span class="pre">SIGMA</span></code>. A simple <code class="docutils literal notranslate"><span class="pre">diff</span></code> is used and the last value is repeated at the end.</p>
<p>Some deglitching of N2 happens in <code class="docutils literal notranslate"><span class="pre">sum_eq08.m</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rhoav</span> <span class="o">=</span> <span class="n">cham</span><span class="o">.</span><span class="n">pden</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">data</span> <span class="o">+</span> <span class="mi">1000</span>
<span class="n">rhoav</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">profile</span> <span class="o">=</span> <span class="n">cham</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="c1"># 1m spacing so a simple diff is the gradient...</span>
<span class="n">profile</span><span class="o">.</span><span class="n">theta</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;dtheta/dz&quot;</span><span class="p">)</span>
<span class="n">profile</span><span class="o">.</span><span class="n">sortT</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;d/dz sorted by ρ&quot;</span><span class="p">)</span>
<span class="n">profile</span><span class="o">.</span><span class="n">sortTbyT</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;d/dz sorted by T&quot;</span><span class="p">)</span>
<span class="c1"># cham5m.T.isel(time=150).diff(&quot;depth&quot;).plot()</span>
<span class="n">profile</span><span class="o">.</span><span class="n">dTdz</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Sasha&quot;</span><span class="p">)</span>
<span class="n">dcpy</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">liney</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">profile</span> <span class="o">=</span> <span class="n">cham</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="c1"># 1m spacing so a simple diff is the gradient...</span>
<span class="n">profile</span><span class="o">.</span><span class="n">pden</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;dpden/dz&quot;</span><span class="p">)</span>
<span class="n">thorpesort</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">pden</span><span class="p">,</span> <span class="n">profile</span><span class="o">.</span><span class="n">pden</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;d/dz sorted by ρ&quot;</span><span class="p">)</span>
<span class="c1"># cham5m.T.isel(time=150).diff(&quot;depth&quot;).plot()</span>
<span class="n">profile</span><span class="o">.</span><span class="n">DRHODZ</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Sasha&quot;</span><span class="p">)</span>
<span class="n">dcpy</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">liney</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">da</span> <span class="ow">in</span> <span class="p">[</span>
    <span class="n">cham</span><span class="o">.</span><span class="n">N2</span><span class="p">,</span>
    <span class="p">(</span><span class="mf">9.81</span> <span class="o">/</span> <span class="mi">1025</span> <span class="o">*</span> <span class="n">cham</span><span class="o">.</span><span class="n">pden</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">)),</span>
    <span class="p">(</span><span class="mf">9.81</span> <span class="o">/</span> <span class="mi">1025</span> <span class="o">*</span> <span class="n">thorpesort</span><span class="p">(</span><span class="n">cham</span><span class="o">.</span><span class="n">pden</span><span class="p">,</span> <span class="n">cham</span><span class="o">.</span><span class="n">pden</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">)),</span>
<span class="p">]:</span>
    <span class="n">da</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
        <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s2">&quot;step&quot;</span>
    <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;sasha&quot;</span><span class="p">,</span> <span class="s2">&quot;pden&quot;</span><span class="p">,</span> <span class="s2">&quot;pden sorted&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cham</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">cham</span><span class="o">.</span><span class="n">sortT</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">cham</span><span class="o">.</span><span class="n">sortTbyT</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="different-jq-calculations">
<h2>Different Jq calculations<a class="headerlink" href="#different-jq-calculations" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">cham5m</span> <span class="o">=</span> <span class="n">cham</span>

<span class="n">cham</span><span class="o">.</span><span class="n">dTdz</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">cham5m</span><span class="o">.</span><span class="n">sortT</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">cham5m</span><span class="o">.</span><span class="n">sortTbyT</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$∂T/∂z$&quot;</span><span class="p">)</span>

<span class="n">_</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cham</span><span class="o">.</span><span class="n">dTdz</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="n">histtype</span><span class="o">=</span><span class="s2">&quot;step&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Sasha&quot;</span>
<span class="p">)</span>
<span class="n">cham5m</span><span class="o">.</span><span class="n">sortT</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="n">histtype</span><span class="o">=</span><span class="s2">&quot;step&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;T sorted by ρ&quot;</span>
<span class="p">)</span>
<span class="n">cham5m</span><span class="o">.</span><span class="n">sortTbyT</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="n">histtype</span><span class="o">=</span><span class="s2">&quot;step&quot;</span><span class="p">,</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span>
    <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;T sorted by T&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$∂T/∂z$&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Jq_</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Tname</span><span class="p">):</span>
    <span class="n">dTdz</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">Tname</span><span class="p">]</span><span class="o">.</span><span class="n">differentiate</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">1025</span> <span class="o">*</span> <span class="mi">4000</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">chi</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">chi</span> <span class="o">&lt;</span> <span class="mf">1e-2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">dTdz</span>


<span class="n">_</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Jq_</span><span class="p">(</span><span class="n">cham</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span>
    <span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
        <span class="n">histtype</span><span class="o">=</span><span class="s2">&quot;step&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Sasha&quot;</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">Jq_</span><span class="p">(</span><span class="n">cham</span><span class="p">,</span> <span class="s2">&quot;sortT&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="n">histtype</span><span class="o">=</span><span class="s2">&quot;step&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;T sorted by ρ&quot;</span>
<span class="p">)</span>
<span class="n">Jq_</span><span class="p">(</span><span class="n">cham</span><span class="p">,</span> <span class="s2">&quot;sortTbyT&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="n">histtype</span><span class="o">=</span><span class="s2">&quot;step&quot;</span><span class="p">,</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span>
    <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;T sorted by T&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$J_q^χ$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">profile</span> <span class="o">=</span> <span class="n">cham</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="c1"># profile.N2.plot()</span>
<span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">DRHODZ</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="p">(</span><span class="n">thorpesort</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">pden</span><span class="p">,</span> <span class="n">profile</span><span class="o">.</span><span class="n">pden</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="n">j</span> <span class="o">=</span> <span class="n">Jq</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">min_dTdz</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
    <span class="n">hdl</span> <span class="o">=</span> <span class="n">j</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">j</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="n">j</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">color</span><span class="o">=</span><span class="n">hdl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">(),</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">j</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">hdl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">(),</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>


<span class="n">plot</span><span class="p">(</span><span class="n">chamρ</span><span class="p">,</span> <span class="s2">&quot;sorted by ρ&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">chamT</span><span class="p">,</span> <span class="s2">&quot;sorted by T&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$J_q^χ$&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="j-q-vs-j-q">
<h2><span class="math notranslate nohighlight">\(J_q^ε\)</span> vs <span class="math notranslate nohighlight">\(J_q^χ\)</span><a class="headerlink" href="#j-q-vs-j-q" title="Permalink to this headline">¶</a></h2>
<p>\begin{align*}
J_q^χ &amp;= ρ c_p K_T T_z = ρ c_p \frac{χ/2}{T_z^2} T_z \
J_q^ε &amp;= ρ c_p K_ρ T_z = ρ c_p \frac{Γε}{N²} T_z
\end{align*}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#xr.set_options(use_numpy_groupies=False)</span>
<span class="c1">#cham_legacy = pump.tspace.regrid_chameleon(</span>
    <span class="c1"># These thresholds make a big difference! but really it&#39;s a very small number of points</span>
<span class="c1">#    cham.where((cham.chi &lt; 1e-2) &amp; (cham.eps &lt; 1e-5))</span>
<span class="c1">#    .sel(depth=slice(156))</span>
<span class="c1">#    .where(cham.depth &gt; cham.mld + 5)</span>
<span class="c1">#    .isel(time=slice(24 * 6)),</span>
<span class="c1">#    time_freq=&quot;3H&quot;,</span>
<span class="c1">#    bins=bins,</span>
<span class="c1">#    trim_mld=False,</span>
<span class="c1">#)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cham_legacy</span><span class="o">.</span><span class="n">chi</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;theta_c&quot;</span><span class="p">)</span>
<span class="n">cham_npg</span><span class="o">.</span><span class="n">chi</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;theta_c&quot;</span><span class="p">)</span>

<span class="p">(</span><span class="n">cham_legacy</span><span class="o">.</span><span class="n">nobs</span><span class="o">-</span><span class="n">cham_npg</span><span class="o">.</span><span class="n">nobs</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;theta_bins&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Reds</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># xr.set_options(use_flox=True)</span>
<span class="n">cham_npg</span> <span class="o">=</span> <span class="n">pump</span><span class="o">.</span><span class="n">tspace</span><span class="o">.</span><span class="n">regrid_chameleon</span><span class="p">(</span>
    <span class="c1"># These thresholds make a big difference! but really it&#39;s a very small number of points</span>
    <span class="n">cham</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">cham</span><span class="o">.</span><span class="n">chi</span> <span class="o">&lt;</span> <span class="mf">1e-2</span><span class="p">))</span>
    <span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">156</span><span class="p">))</span>
    <span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cham</span><span class="o">.</span><span class="n">depth</span> <span class="o">&gt;</span> <span class="n">cham</span><span class="o">.</span><span class="n">mld</span> <span class="o">+</span> <span class="mi">5</span><span class="p">),</span>
    <span class="c1"># .isel(time=slice(24 * 6)),</span>
    <span class="n">time_freq</span><span class="o">=</span><span class="s2">&quot;3H&quot;</span><span class="p">,</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">Tbins</span><span class="p">,</span>
    <span class="n">trim_mld</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cham_Tspace</span> <span class="o">=</span> <span class="n">cham_npg</span>
<span class="n">cham_Tmean</span> <span class="o">=</span> <span class="n">cham_Tspace</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="n">cham_Tmean</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;z_c&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cham_Tspace</span><span class="o">.</span><span class="n">z_c</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.dpi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">140</span>

<span class="n">cham_Tspace</span><span class="o">.</span><span class="n">nobs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">cham_Tmean</span><span class="o">.</span><span class="n">Jq</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;z_c&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fdca55ae190&gt;]
</pre></div>
</div>
<img alt="_images/equix-examine_28_1.png" src="_images/equix-examine_28_1.png" />
<img alt="_images/equix-examine_28_2.png" src="_images/equix-examine_28_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">N2rho</span> <span class="o">=</span> <span class="mf">9.81</span> <span class="o">/</span> <span class="mi">1025</span> <span class="o">*</span> <span class="n">cham</span><span class="o">.</span><span class="n">pden</span><span class="o">.</span><span class="n">differentiate</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">)</span>
<span class="n">N2sort</span> <span class="o">=</span> <span class="mf">9.81</span> <span class="o">/</span> <span class="mi">1025</span> <span class="o">*</span> <span class="n">thorpesort</span><span class="p">(</span><span class="n">cham</span><span class="o">.</span><span class="n">pden</span><span class="p">,</span> <span class="n">cham</span><span class="o">.</span><span class="n">pden</span><span class="p">)</span><span class="o">.</span><span class="n">differentiate</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">cham_</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
    <span class="p">[</span><span class="n">cham</span><span class="p">,</span> <span class="n">chamρ</span><span class="p">,</span> <span class="n">chamT</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">&quot;2009 paper&quot;</span><span class="p">,</span> <span class="s2">&quot;$T_z$ with T sorted by ρ&quot;</span><span class="p">,</span> <span class="s2">&quot;$T_z$ with T sorted by T&quot;</span><span class="p">],</span>
<span class="p">):</span>
    <span class="p">(</span><span class="mi">1025</span> <span class="o">*</span> <span class="mi">4000</span> <span class="o">*</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">cham</span><span class="o">.</span><span class="n">eps</span> <span class="o">/</span> <span class="n">cham</span><span class="o">.</span><span class="n">N2</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cham</span><span class="o">.</span><span class="n">N2</span> <span class="o">&gt;</span> <span class="mf">5e-6</span><span class="p">)</span> <span class="o">*</span> <span class="n">cham_</span><span class="o">.</span><span class="n">dTdz</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
        <span class="s2">&quot;time&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">y</span><span class="o">=</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span>
        <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="c1"># color=&quot;k&quot;,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$J_q^ε = ρ c_p K_ρ T_z$&quot;</span><span class="p">)</span>


<span class="k">for</span> <span class="n">cham_</span><span class="p">,</span> <span class="n">axx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">chamρ</span><span class="p">,</span> <span class="n">chamT</span><span class="p">],</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">Jq</span><span class="p">(</span><span class="n">cham</span><span class="p">,</span> <span class="n">min_dTdz</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">y</span><span class="o">=</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span>
        <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$J_q^χ$ (2009 paper)&quot;</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">axx</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">min_dTdz</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">5e-3</span><span class="p">]:</span>
        <span class="n">Jq</span><span class="p">(</span><span class="n">cham_</span><span class="p">,</span> <span class="n">min_dTdz</span><span class="o">=</span><span class="n">min_dTdz</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">y</span><span class="o">=</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span>
            <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$T_z$ &gt; </span><span class="si">{</span><span class="n">min_dTdz</span><span class="si">:</span><span class="s2">.0e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">axx</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="n">axx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$J_q^χ = ρ c_p K_T T_z$&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">axx</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
    <span class="n">cham_Tmean</span><span class="o">.</span><span class="n">Jq</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">y</span><span class="o">=</span><span class="s2">&quot;z_c&quot;</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$J_q^χ$ Tspace&quot;</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">axx</span><span class="p">,</span>
        <span class="n">_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">iop</span><span class="o">.</span><span class="n">Jq</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">y</span><span class="o">=</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;v&quot;</span><span class="p">,</span>
        <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$J_q^χ$ EQUIX IOP&quot;</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">axx</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
        <span class="n">_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">tao_iop</span><span class="o">.</span><span class="n">Jq</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">y</span><span class="o">=</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;^&quot;</span><span class="p">,</span>
        <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$J_q^χ$ TAO IOP&quot;</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">axx</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
        <span class="n">_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;T sorted by ρ&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;T sorted by T&quot;</span><span class="p">)</span>
<span class="c1"># (4e6 * 0.2 * cham.eps / cham.N2.where(mask) * cham.dTdz).mean(&quot;time&quot;).plot(</span>
<span class="c1">#    y=&quot;depth&quot;, yincrease=False, ylim=[150, 20], xlim=[-1000, 1000]</span>
<span class="c1"># )</span>

<span class="c1"># (Jq(cham5m)).mean(&quot;time&quot;).plot(y=&quot;depth&quot;, yincrease=False)</span>
<span class="c1"># (4e6 * 0.2 * cham5m.eps / cham5m.N2.where(mask) * cham5m.dTdz).mean(&quot;time&quot;).plot(</span>
<span class="c1">#    y=&quot;depth&quot;, yincrease=False, ylim=[150, 20], xlim=[-1000, 1000]</span>
<span class="c1"># )</span>

<span class="c1"># cham5m.Jq_χ.mean(&quot;time&quot;).plot(y=&quot;depth&quot;, yincrease=False, color=&quot;k&quot;, ls=&quot;--&quot;)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">600</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">160</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">]</span>
<span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">]</span>
<span class="n">dcpy</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">clean_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;../images/equix-jq-iop-cham-vs-chipod.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/equix-examine_29_0.png" src="_images/equix-examine_29_0.png" />
</div>
</div>
</div>
<div class="section" id="perlin-moum">
<h2>Perlin &amp; Moum:<a class="headerlink" href="#perlin-moum" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>χ, ε<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Reproducing Perlin &amp; Moum</p>
<ol class="simple">
<li><p>75m TAO ε is low</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">axx</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="s2">&quot;chi&quot;</span><span class="p">,</span> <span class="s2">&quot;eps&quot;</span><span class="p">],</span> <span class="n">axx</span><span class="p">))</span>

<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
    <span class="n">cham</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cham</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">1e-3</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;cham&quot;</span>
    <span class="p">)</span>
    <span class="n">iop</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;EQUIX&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">tao_iop</span><span class="p">[</span><span class="n">var</span> <span class="o">+</span> <span class="s2">&quot;1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;TAO&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="c1"># iop[var + &quot;2&quot;].mean(&quot;time&quot;).cf.plot(marker=&quot;.&quot;, ls=&quot;none&quot;, label=&quot;IOP&quot;, color=&#39;r&#39;, ax=ax[var])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">tao_iop</span><span class="p">[</span><span class="n">var</span> <span class="o">+</span> <span class="s2">&quot;2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">markerfacecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
        <span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
        <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;TAO&quot;</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">var</span><span class="p">],</span>
    <span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="s2">&quot;chi&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mf">1e-7</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="s2">&quot;chi&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">145</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="s2">&quot;chi&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">125</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">])</span>
<span class="n">dcpy</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">linex</span><span class="p">([</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mf">6e-6</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="s2">&quot;chi&quot;</span><span class="p">])</span>

<span class="n">ax</span><span class="p">[</span><span class="s2">&quot;eps&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mf">2e-9</span><span class="p">,</span> <span class="mf">2e-5</span><span class="p">])</span>
<span class="n">dcpy</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">linex</span><span class="p">([</span><span class="mf">5e-7</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="mf">2e-6</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="s2">&quot;eps&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/equix-examine_31_0.png" src="_images/equix-examine_31_0.png" />
</div>
</div>
<p>59m χpod sensor 2 is low, does not match Perlin &amp; Moum.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tao_iop</span><span class="o">.</span><span class="n">chi1</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">58</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">tao_iop</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">58</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fdcb8ee7a60&gt;]
</pre></div>
</div>
<img alt="_images/equix-examine_33_1.png" src="_images/equix-examine_33_1.png" />
</div>
</div>
</div>
<div class="section" id="tz-n2">
<h3>Tz, N2<a class="headerlink" href="#tz-n2" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">axx</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="s2">&quot;dTdz&quot;</span><span class="p">,</span> <span class="s2">&quot;N2&quot;</span><span class="p">],</span> <span class="n">axx</span><span class="p">))</span>

<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
    <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cham</span><span class="p">[</span><span class="n">var</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;cham&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">var</span> <span class="o">!=</span> <span class="s2">&quot;N2&quot;</span><span class="p">:</span>
        <span class="n">iop</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;IOP&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">var</span><span class="p">])</span>
        <span class="n">tao_iop</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;TAO&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">var</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">var</span> <span class="o">==</span> <span class="s2">&quot;N2&quot;</span><span class="p">:</span>
        <span class="n">cham</span><span class="p">[</span><span class="s2">&quot;NT2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;cham $N_T^2$&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">var</span><span class="p">])</span>
        <span class="n">iop</span><span class="p">[</span><span class="s2">&quot;NT2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;IOP $N_T^2$&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">var</span><span class="p">])</span>
        <span class="n">tao_iop</span><span class="p">[</span><span class="s2">&quot;NT21&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;TAO $N_T^2$&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">var</span><span class="p">])</span>
        <span class="n">tao_iop</span><span class="p">[</span><span class="s2">&quot;NT22&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">var</span><span class="p">])</span>
        
    <span class="n">ax</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="s2">&quot;N2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$N^2$&quot;</span><span class="p">)</span>
<span class="c1">#ax[&quot;dTdz&quot;].set_xlim([7.5e-4, 2e-3])</span>
<span class="c1">#ax[&quot;N2&quot;].set_xlim([7.5e-4, 2e-3]) </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;$N^2$&#39;)
</pre></div>
</div>
<img alt="_images/equix-examine_35_1.png" src="_images/equix-examine_35_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="tiwe">
<h2>TIWE<a class="headerlink" href="#tiwe" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tiwe</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;/home/deepak/datasets/microstructure/osu/tiwe.nc&quot;</span><span class="p">)</span>
<span class="n">tiwe</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tiwe</span><span class="p">[</span><span class="s2">&quot;Jq_ε&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="mi">1025</span>
    <span class="o">*</span> <span class="mi">4000</span>
    <span class="o">*</span> <span class="mf">0.2</span>
    <span class="o">*</span> <span class="n">tiwe</span><span class="o">.</span><span class="n">eps</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tiwe</span><span class="o">.</span><span class="n">eps</span> <span class="o">&lt;</span> <span class="mf">1e-5</span><span class="p">)</span>
    <span class="o">/</span> <span class="n">tiwe</span><span class="o">.</span><span class="n">N2</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tiwe</span><span class="o">.</span><span class="n">N2</span> <span class="o">&gt;</span> <span class="mf">1e-6</span><span class="p">)</span>
    <span class="o">*</span> <span class="n">tiwe</span><span class="o">.</span><span class="n">dTdz</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tiwe</span><span class="o">.</span><span class="n">dTdz</span> <span class="o">&gt;</span> <span class="mf">1e-4</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">tiwe</span><span class="p">[</span><span class="s2">&quot;Jq_χ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="mi">1025</span>
    <span class="o">*</span> <span class="mi">4000</span>
    <span class="o">*</span> <span class="n">tiwe</span><span class="o">.</span><span class="n">chi</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tiwe</span><span class="o">.</span><span class="n">eps</span> <span class="o">&lt;</span> <span class="mf">1e-5</span><span class="p">)</span>
    <span class="o">/</span> <span class="mi">2</span>
    <span class="o">/</span> <span class="n">tiwe</span><span class="o">.</span><span class="n">dTdz</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tiwe</span><span class="o">.</span><span class="n">sortT</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">1e-3</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">tiwe</span><span class="o">.</span><span class="n">Jq</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;depth&quot;</span><span class="p">)</span>
<span class="n">tiwe</span><span class="o">.</span><span class="n">Jq_ε</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;depth&quot;</span><span class="p">)</span>
<span class="n">tiwe</span><span class="o">.</span><span class="n">Jq_χ</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="reproducing-perlin-moum-2012">
<h2>Reproducing Perlin &amp; Moum (2012)<a class="headerlink" href="#reproducing-perlin-moum-2012" title="Permalink to this headline">¶</a></h2>
<p>I’m tuning max allowable χ, ε to visually match Perlin &amp; Moum</p>
<ol class="simple">
<li><p>Deepest 2 TAO χpods seem to be at wrong depths</p></li>
<li><p>TAO at 18m, 75m is too low.</p></li>
<li><p>~Need to save both sensors separately. If I did average then that’s an issue here.~ I did not average, just followed the comment and always picked sensor 1.</p></li>
</ol>
<p>TODO:</p>
<ol class="simple">
<li><p>Find all other sensor 2 data for EQUIX.</p></li>
<li><p>See if I can find Sasha’s merged files</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">axx</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;chi&quot;</span><span class="p">,</span> <span class="s2">&quot;eps&quot;</span><span class="p">]):</span>
    <span class="n">cham</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">cham</span><span class="o">.</span><span class="n">chi</span> <span class="o">&lt;</span> <span class="mf">1e-2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">cham</span><span class="o">.</span><span class="n">eps</span> <span class="o">&lt;</span> <span class="mf">6e-5</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-7</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">140</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axx</span>
    <span class="p">)</span>
    <span class="n">iop</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">y</span><span class="o">=</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axx</span>
    <span class="p">)</span>
    <span class="n">tao_iop</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">y</span><span class="o">=</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axx</span>
    <span class="p">)</span>
    <span class="n">tao_iop</span><span class="p">[</span><span class="n">var</span> <span class="o">+</span> <span class="s2">&quot;2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">y</span><span class="o">=</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axx</span><span class="p">,</span> <span class="n">fillstyle</span><span class="o">=</span><span class="s2">&quot;none&quot;</span>
    <span class="p">)</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">125</span><span class="p">])</span>
<span class="n">dcpy</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">liney</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">dcpy</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">linex</span><span class="p">([</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mf">5e-6</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">dcpy</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">linex</span><span class="p">([</span><span class="mf">5e-7</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="mf">2e-6</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="explorations">
<h2>Explorations<a class="headerlink" href="#explorations" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cham5m</span> <span class="o">=</span> <span class="n">cham</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cham5m</span><span class="p">[</span><span class="s2">&quot;dTdz&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cham5m</span><span class="o">.</span><span class="n">sortT</span><span class="o">.</span><span class="n">differentiate</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">)</span>
<span class="c1"># cham5m[&quot;dTdz&quot;] = cham5m.theta.diff(&quot;depth&quot;)# / cham5m.depth.diff(&quot;depth&quot;)</span>
<span class="c1"># cham5m[&quot;dTdz&quot;] = cham5m.dTdz.where(np.abs(cham5m.dTdz) &gt; 5e-3)</span>
<span class="n">cham5m</span><span class="p">[</span><span class="s2">&quot;N2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">9.81</span> <span class="o">/</span> <span class="mi">1025</span> <span class="o">*</span> <span class="n">cham5m</span><span class="o">.</span><span class="n">pden</span><span class="o">.</span><span class="n">differentiate</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">)</span>

<span class="n">cham5m</span> <span class="o">=</span> <span class="n">cham5m</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">cham5m</span><span class="o">.</span><span class="n">N2</span> <span class="o">&gt;</span> <span class="mf">5e-6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cham5m</span><span class="o">.</span><span class="n">dTdz</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-3</span><span class="p">))</span>
<span class="c1"># cham5m[&quot;N2&quot;] = np.abs(cham5m.N2.where(cham5m.N2 &gt; 5e-6))</span>

<span class="n">cham5m</span><span class="p">[</span><span class="s2">&quot;KT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">cham5m</span><span class="o">.</span><span class="n">chi</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">cham5m</span><span class="o">.</span><span class="n">dTdz</span> <span class="o">**</span> <span class="mi">2</span>
<span class="p">)</span>  <span class="c1"># .where(np.abs(cham5m.dTdz) &gt; 1e-3) ** 2</span>
<span class="n">cham5m</span><span class="o">.</span><span class="n">KT</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;$K_T$&quot;</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;m²/s&quot;</span><span class="p">}</span>
<span class="n">cham5m</span><span class="p">[</span><span class="s2">&quot;Kρ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">cham5m</span><span class="o">.</span><span class="n">eps</span> <span class="o">/</span> <span class="n">cham5m</span><span class="o">.</span><span class="n">N2</span>
<span class="n">cham5m</span><span class="o">.</span><span class="n">Kρ</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;$K_ρ$&quot;</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;m²/s&quot;</span><span class="p">}</span>
<span class="n">cham5m</span><span class="o">.</span><span class="n">chi</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cham5m</span><span class="o">.</span><span class="n">chi</span> <span class="o">&lt;</span> <span class="mf">1e-3</span><span class="p">)</span>

<span class="n">cham5m</span><span class="p">[</span><span class="s2">&quot;Jq_χ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1025</span> <span class="o">*</span> <span class="mi">4000</span> <span class="o">*</span> <span class="n">cham5m</span><span class="o">.</span><span class="n">KT</span> <span class="o">*</span> <span class="n">cham5m</span><span class="o">.</span><span class="n">dTdz</span>
<span class="n">cham5m</span><span class="o">.</span><span class="n">Jq_χ</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;$J_q^χ$&quot;</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;W/m²&quot;</span><span class="p">}</span>
<span class="n">cham5m</span><span class="p">[</span><span class="s2">&quot;Jq_ε&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1025</span> <span class="o">*</span> <span class="mi">4000</span> <span class="o">*</span> <span class="n">cham5m</span><span class="o">.</span><span class="n">Kρ</span> <span class="o">*</span> <span class="n">cham5m</span><span class="o">.</span><span class="n">dTdz</span>
<span class="n">cham5m</span><span class="o">.</span><span class="n">Jq_ε</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;$J_q^ε$&quot;</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;W/m²&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cham5m</span><span class="o">.</span><span class="n">KT</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">35</span><span class="p">),</span>
    <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span>
    <span class="n">histtype</span><span class="o">=</span><span class="s2">&quot;step&quot;</span><span class="p">,</span>
    <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$K_T$&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">cham5m</span><span class="o">.</span><span class="n">Kρ</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">35</span><span class="p">),</span>
    <span class="n">histtype</span><span class="o">=</span><span class="s2">&quot;step&quot;</span><span class="p">,</span>
    <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span>
    <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$K_ρ$&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">4e6</span> <span class="o">*</span> <span class="n">cham5m</span><span class="o">.</span><span class="n">KT</span> <span class="o">*</span> <span class="n">cham5m</span><span class="o">.</span><span class="n">dTdz</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1500</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">histtype</span><span class="o">=</span><span class="s2">&quot;step&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$J_q^χ$&quot;</span>
<span class="p">)</span>
<span class="p">(</span><span class="mf">4e6</span> <span class="o">*</span> <span class="n">cham5m</span><span class="o">.</span><span class="n">Kρ</span> <span class="o">*</span> <span class="n">cham5m</span><span class="o">.</span><span class="n">dTdz</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1500</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">histtype</span><span class="o">=</span><span class="s2">&quot;step&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$J_q^ε$&quot;</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">axx</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">cham5m</span><span class="o">.</span><span class="n">KT</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$K_T$&quot;</span><span class="p">)</span>
<span class="n">cham5m</span><span class="o">.</span><span class="n">Kρ</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$K_ρ$&quot;</span><span class="p">)</span>

<span class="n">cham5m</span><span class="o">.</span><span class="n">Jq_χ</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cham5m</span><span class="o">.</span><span class="n">dTdz</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axx</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$J_q^χ$&quot;</span><span class="p">)</span>
<span class="n">cham5m</span><span class="o">.</span><span class="n">Jq_ε</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cham5m</span><span class="o">.</span><span class="n">dTdz</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">700</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">axx</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$J_q^ε$&quot;</span>
<span class="p">)</span>

<span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axx</span><span class="o">.</span><span class="n">flat</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "conda-env-pump-py"
        },
        kernelOptions: {
            kernelName: "conda-env-pump-py",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'conda-env-pump-py'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="equix-divergence.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">EQUIX: Jq divergence</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="long-term-turbulence.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Long-term tubulence in 20-year simulation</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Deepak Cherian<br/>
    
        &copy; Copyright 2021.<br/>
      <div class="extra_footer">
        <div>
<script data-goatcounter="https://count.cherian.net/count"
        async src="count.js"></script>
</div>

      </div>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>